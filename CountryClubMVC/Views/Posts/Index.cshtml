@model IEnumerable<CountryClubMVC.Models.Post>

    @{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
    }
    @{
    CountryClubMVC.Models.User _user = new CountryClubMVC.Models.User();
    CountryClubMVC.Models.AppDbContext db = new CountryClubMVC.Models.AppDbContext();

    if (HttpContext.Current.Session["User"] != null)
    {
    _user = (CountryClubMVC.Models.User)HttpContext.Current.Session["User"];
    ViewBag.Name = _user.Username;
    ViewBag.FamID = _user.Family_ID;
    ViewBag.UserID = _user.User_ID;
    ViewBag.DP = _user.DisplayPicture ?? "../../Content/NewContent/dist/img/user2-160x160.jpg";
    }
    }


    <h2>Home</h2>


    <p>
        <i class="glyphicon glyphicon-plus"></i>
        @Html.ActionLink("Create New", "Create")
    </p>

    <table class="table">


        @foreach (var item in Model)
        {
        //Get userID  of Post
        var PostUserID = item.User_ID;
        //Get displayPic tied to that ID
        var postUser = db.Users.Find(PostUserID);
        //Set Poster's image to
        var postDP = postUser.DisplayPicture;
        //Get nand humanize Datetime
        var time = Convert.ToDateTime(item.TimePosted).ToString("h:mm tt  dddd, dd MMMM yyyy ");
        //Get Poster's Profile link
        var posterProfile = "Profile/"+ PostUserID;
        ViewBag.posterProfile = "Profile/"+ PostUserID;


        <div class="col-md-8">
            <!-- Box Comment -->
            <div class="box box-widget">
                <div class="box-header with-border">
                    <div class="user-block">
                        <img src="@postDP" class="img-circle" width="25px" alt="DP">
                        @*Username should link to Profile*@
                        <span class="username"><a href="@Url.Action(@ViewBag.posterProfile, "Users")">@postUser.Username</a></span>
                        <span class="description">Shared publicly - @time</span>
                    </div>
                    <!-- /.user-block -->
                    <div class="box-tools">

                        <button type="button" class="btn btn-box-tool" data-widget="collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="edit"><i class="fa fa-bars"></i></button>
                    </div>
                    <!-- /.box-tools -->
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    @*Place a condition to display image if not null*@
                    @{
                    if (item.Image != null)
                    {
                    <img class="img-responsive pad" src="@item.Image" alt="Post Image">
                    }
                    }
                    @**@

                    <p>@item.Content</p>
                    <button type="button" class="btn btn-default btn-xs"><i class="fa fa-share"></i> Share</button>
                    <button type="button" class="btn btn-default btn-xs"><i class="fa fa-thumbs-o-up"></i> Like</button>
                    <span class="pull-right text-muted">@item.Likes likes - 0 comments</span>
                </div>
                @*Comments*@
                <!-- /.box-body -->
                @*<div class="box-footer box-comments">
                    <div class="box-comment">
                        <!-- User image -->
                        <img class="img-circle img-sm" src="../dist/img/user3-128x128.jpg" alt="User Image">

                        <div class="comment-text">
                            <span class="username">
                                Maria Gonzales
                                <span class="text-muted pull-right">8:03 PM Today</span>
                            </span><!-- /.username -->
                            It is a long established fact that a reader will be distracted
                            by the readable content of a page when looking at its layout.
                        </div>
                        <!-- /.comment-text -->
                    </div>
                    <!-- /.box-comment -->
                    <div class="box-comment">
                        <!-- User image -->
                        <img class="img-circle img-sm" src="../dist/img/user4-128x128.jpg" alt="User Image">

                        <div class="comment-text">
                            <span class="username">
                                Luna Stark
                                <span class="text-muted pull-right">8:03 PM Today</span>
                            </span><!-- /.username -->
                            It is a long established fact that a reader will be distracted
                            by the readable content of a page when looking at its layout.
                        </div>
                        <!-- /.comment-text -->
                    </div>
                    <!-- /.box-comment -->
                </div>*@
                <!-- /.box-footer -->
                <div class="box-footer">
                    <form action="#" method="post">
                        <img src="@ViewBag.DP" class="img-circle img-sm" width="25px" alt="DP">
                        <!-- .img-push is used to add margin to elements next to floating images -->
                        <div class="img-push">
                            <input type="text" class="form-control input-sm" placeholder="Press enter to post comment">
                        </div>
                    </form>
                </div>
                <!-- /.box-footer -->
            </div>
            <!-- /.box -->
        </div>
        @*
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Content)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Likes)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Image)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.TimePosted)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.TimeEdited)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.User_ID)
            </td>
            <td>
                @Html.ActionLink("Edit", "Edit", new { id = item.Post_ID }) |
                @Html.ActionLink("Details", "Details", new { id = item.Post_ID }) |
                @Html.ActionLink("Delete", "Delete", new { id = item.Post_ID })
            </td>
        </tr>*@
        }

    </table>


